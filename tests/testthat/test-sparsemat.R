test_that("multiplication works", {
  # library(Matrix)
  # set.seed(42)
  # A <- Matrix(rbinom(100,10,0.05), nrow = 10)
  # rownames(A)=letters[1:10]
  # colnames(A)=LETTERS[1:10]
  A=new("dgCMatrix", i = c(0L, 1L, 3L, 4L, 6L, 8L, 9L, 1L, 2L, 5L,
6L, 0L, 2L, 3L, 7L, 9L, 0L, 1L, 3L, 5L, 8L, 9L, 3L, 5L, 6L, 7L,
8L, 9L, 3L, 5L, 6L, 0L, 1L, 2L, 4L, 7L, 8L, 5L, 3L, 4L, 0L, 3L,
4L, 5L, 8L, 9L), p = c(0L, 7L, 11L, 16L, 22L, 28L, 31L, 37L,
38L, 40L, 46L), Dim = c(10L, 10L), Dimnames = list(c("a", "b",
"c", "d", "e", "f", "g", "h", "i", "j"), c("A", "B", "C", "D",
"E", "F", "G", "H", "I", "J")), x = c(2, 2, 1, 1, 1, 1, 1, 1,
2, 2, 2, 1, 3, 2, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 2, 1, 1,
1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1), factors = list())
  colScaleM(A)
  csA=new("dgCMatrix", i = c(0L, 1L, 3L, 4L, 6L, 8L, 9L, 1L, 2L, 5L,
6L, 0L, 2L, 3L, 7L, 9L, 0L, 1L, 3L, 5L, 8L, 9L, 3L, 5L, 6L, 7L,
8L, 9L, 3L, 5L, 6L, 0L, 1L, 2L, 4L, 7L, 8L, 5L, 3L, 4L, 0L, 3L,
4L, 5L, 8L, 9L), p = c(0L, 7L, 11L, 16L, 22L, 28L, 31L, 37L,
38L, 40L, 46L), Dim = c(10L, 10L), Dimnames = list(c("a", "b",
"c", "d", "e", "f", "g", "h", "i", "j"), c("A", "B", "C", "D",
"E", "F", "G", "H", "I", "J")), x = c(0.222222222222222, 0.222222222222222,
0.111111111111111, 0.111111111111111, 0.111111111111111, 0.111111111111111,
0.111111111111111, 0.142857142857143, 0.285714285714286, 0.285714285714286,
0.285714285714286, 0.125, 0.375, 0.25, 0.125, 0.125, 0.166666666666667,
0.166666666666667, 0.166666666666667, 0.166666666666667, 0.166666666666667,
0.166666666666667, 0.222222222222222, 0.222222222222222, 0.111111111111111,
0.111111111111111, 0.222222222222222, 0.111111111111111, 0.333333333333333,
0.333333333333333, 0.333333333333333, 0.142857142857143, 0.285714285714286,
0.142857142857143, 0.142857142857143, 0.142857142857143, 0.142857142857143,
1, 0.5, 0.5, 0.125, 0.25, 0.25, 0.125, 0.125, 0.125), factors = list())
  expect_equal(colScaleM(A), csA)
})
